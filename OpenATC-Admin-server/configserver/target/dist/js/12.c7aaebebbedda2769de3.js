webpackJsonp([12],{M0ZN:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=t("BO1k"),i=t.n(o),a=t("mvHQ"),r=t.n(a),s=t("BtRb"),c=t("TIfe");var l={name:"optimize",data:function(){return{tableHeight:760,screenHeight:window.innerHeight,listLoading:!1,form:{name:"",region:"",type:[]},checked:!1,optimizeList:[]}},directives:{clickoutside:{bind:function(n,e,t){function o(t){if(n.contains(t.target))return!1;e.expression&&e.value(t)}n.__vueClickOutside__=o,document.addEventListener("click",o)},update:function(){},unbind:function(n,e){document.removeEventListener("click",n.__vueClickOutside__),delete n.__vueClickOutside__}}},created:function(){this.getParams()},mounted:function(){var n=this;n.$nextTick(function(){n.tableHeight=window.innerHeight-document.querySelector("#footerBtn").offsetTop-110,window.onresize=function(){n.screenHeight=window.innerHeight}})},watch:{screenHeight:function(){this.tableHeight=window.innerHeight-document.querySelector("#footerBtn").offsetTop-50}},methods:{cancelTable:function(n){this.$refs.singleTable.setCurrentRow()},onCommit:function(n){var e=this,t=r()(this.optimizeList),o=0;this.checked&&(o=1),function(n,e){var t=Object(c.c)(),o={agentid:t,override:e,strategytype:"model",jsonparam:n},i=[t,"opt","download"];return new s.a("downloadOptParam").Send({},o,i)}(t,o).then(function(t){t.data.success?(n&&e.commitAndExec(),e.$alert(e.$t("edge.common.download"),{type:"success"})):e.$message.error(t.data.message)}).catch(function(n){e.$message.error(n),console.log(n)})},onCommitAndExec:function(){this.onCommit(!0)},commitAndExec:function(){var n,e=this;(n=[Object(c.c)(),"opt","run","model"],new s.a("downloadOptParam").Send({},{},n)).then(function(n){n.data.success?e.$alert(e.$t("edge.common.downloadandrun"),{type:"success"}):e.$message.error(n.data.message)}).catch(function(n){e.$message.error(n),console.log(n)})},initOptParam:function(){var n,e,t,o=this;(n=Object(c.c)(),e=new s.a("initOptParam"),t={},t.agentid=n,t.operation="get-request",t.infotype="status/optstatparam",e.Send({},t)).then(function(n){var e=n.data;if(!e.success)return"4003"===e.code?void o.$message.error(o.$t("edge.errorTip.devicenotonline")):void o.$message.error(n.data.message);o.getParams()}).catch(function(n){o.$message.error(n),console.log(n)})},getParams:function(){var n,e=this;(n=[Object(c.c)(),"optstatparam"],new s.a("uploadOptParam").Send({},{},n)).then(function(n){var t=n.data;if(!t.success)return"4003"===t.code?void e.$message.error(e.$t("edge.errorTip.devicenotonline")):void e.$message.error(n.data.message);var o=!0,a=!1,r=void 0;try{for(var s,c=i()(t.data);!(o=(s=c.next()).done);o=!0){var l=s.value,d=JSON.parse(l.jsonparam);l.override&&(e.checked=!0);var u=!0,p=!1,m=void 0;try{for(var f,g=i()(d);!(u=(f=g.next()).done);u=!0){var h=f.value;h.maxoccupancy=Math.floor(100*h.maxoccupancy)/100,h.maxspeed=Math.floor(100*h.maxspeed)/100,e.optimizeList.push(h)}}catch(n){p=!0,m=n}finally{try{!u&&g.return&&g.return()}finally{if(p)throw m}}}}catch(n){a=!0,r=n}finally{try{!o&&c.return&&c.return()}finally{if(a)throw r}}}).catch(function(n){e.$message.error(n),console.log(n)})},handdle:function(n,e,t){this.checked&&this.$refs.singleTable.setCurrentRow()}}},d={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"app-container"},[t("el-row",{staticClass:"top-row"},[t("div",{staticClass:"grid-content bg-purple"},[t("span",{staticClass:"sysytem-strategy"},[n._v(n._s(n.$t("edge.optimize.strategy")))]),n._v(" "),t("el-select",{attrs:{placeholder:n.$t("edge.optimize.mathematical"),size:"small"},model:{value:n.form.region,callback:function(e){n.$set(n.form,"region",e)},expression:"form.region"}},[t("el-option",{attrs:{label:n.$t("edge.optimize.mathematical"),value:"数学模型"}})],1),n._v(" "),t("span",{staticStyle:{"margin-left":"15px"}},[t("el-checkbox",{model:{value:n.checked,callback:function(e){n.checked=e},expression:"checked"}},[n._v(n._s(n.$t("edge.optimize.learn")))])],1)],1)]),n._v(" "),t("el-row",{staticClass:"bottom-row"},[t("span",{staticClass:"system-saturation"},[n._v(n._s(n.$t("edge.optimize.saturation")))]),n._v(" "),t("br")]),n._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:n.listLoading,expression:"listLoading",modifiers:{body:!0}},{name:"clickoutside",rawName:"v-clickoutside",value:n.cancelTable,expression:"cancelTable"}],ref:"singleTable",staticClass:"tb-edit",attrs:{data:n.optimizeList,"element-loading-text":"Loading",fit:"","highlight-current-row":"","max-height":n.tableHeight,id:"footerBtn"},on:{"row-click":n.handdle}},[t("el-table-column",{attrs:{align:"center",label:"No","min-width":"40"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("span",[n._v(n._s(e.$index+1))])]}}])}),n._v(" "),t("el-table-column",{staticClass:"table-column",attrs:{label:n.$t("edge.optimize.phase"),"min-width":"150",align:"center",prop:"phaseid"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-input",{attrs:{size:"small"},on:{change:function(t){return n.handleEdit(e.$index,e.row)}},model:{value:e.row.phaseid,callback:function(t){n.$set(e.row,"phaseid",t)},expression:"scope.row.phaseid"}}),n._v(" "),t("span",[n._v(n._s(e.row.phaseid))])]}}])}),n._v(" "),t("el-table-column",{attrs:{align:"center",label:n.$t("edge.optimize.flow"),"min-width":"100",prop:"flow"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-input-number",{staticStyle:{width:"100px"},attrs:{size:"small","controls-position":"right",min:0,max:255,step:1},on:{change:function(t){return n.handleEdit(e.$index,e.row)}},model:{value:e.row.maxflow,callback:function(t){n.$set(e.row,"maxflow",n._n(t))},expression:"scope.row.maxflow"}}),n._v(" "),t("span",[n._v(n._s(e.row.maxflow))])]}}])}),n._v(" "),t("el-table-column",{attrs:{align:"center",label:n.$t("edge.optimize.speed"),"min-width":"100",prop:"speed"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-input-number",{staticStyle:{width:"100px"},attrs:{size:"small","controls-position":"right",min:0,max:255,step:.01},on:{change:function(t){return n.handleEdit(e.$index,e.row)}},model:{value:e.row.maxspeed,callback:function(t){n.$set(e.row,"maxspeed",n._n(t))},expression:"scope.row.maxspeed"}}),n._v(" "),t("span",[n._v(n._s(e.row.maxspeed))])]}}])}),n._v(" "),t("el-table-column",{attrs:{align:"center",label:n.$t("edge.optimize.queue"),"min-width":"100",prop:"queue"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-input-number",{staticStyle:{width:"100px"},attrs:{size:"small","controls-position":"right",min:0,max:255,step:1},on:{change:function(t){return n.handleEdit(e.$index,e.row)}},model:{value:e.row.maxqueue,callback:function(t){n.$set(e.row,"maxqueue",n._n(t))},expression:"scope.row.maxqueue"}}),n._v(" "),t("span",[n._v(n._s(e.row.maxqueue))])]}}])}),n._v(" "),t("el-table-column",{attrs:{align:"center","class-name":"status-col",label:n.$t("edge.optimize.Occupancy"),"min-width":"100",prop:"maxoccupancy"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-input-number",{staticStyle:{width:"100px"},attrs:{size:"small","controls-position":"right",min:0,max:25,step:.01},on:{change:function(t){return n.handleEdit(e.$index,e.row)}},model:{value:e.row.maxoccupancy,callback:function(t){n.$set(e.row,"maxoccupancy",n._n(t))},expression:"scope.row.maxoccupancy"}}),n._v(" "),t("span",[n._v(n._s(e.row.maxoccupancy))])]}}])})],1),n._v(" "),t("div",{staticStyle:{"text-align":"right","margin-top":"20px"}},[t("el-button",{staticClass:"el-icon-check",staticStyle:{"margin-bottom":"10px","font-size":"10px"},attrs:{type:"primary"},on:{click:function(e){return n.onCommit(!1)}}},[n._v(" "+n._s(n.$t("edge.common.commit")))]),n._v(" "),t("el-button",{staticClass:"iconfont icon-tijiaobingzhihang",staticStyle:{"margin-bottom":"10px","font-size":"10px",color:"#b6f0ff"},attrs:{type:"primary"},on:{click:n.onCommitAndExec}},[n._v(" "+n._s(n.$t("edge.common.commitandexecute")))])],1)],1)},staticRenderFns:[]};var u=t("VU/8")(l,d,!1,function(n){t("yqGI")},null,null);e.default=u.exports},"reL/":function(n,e,t){(n.exports=t("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* * {\n    margin: 0;\n    padding: 0;\n} */\n.top-row {\n    margin-bottom: 40px;\n}\n.bottom-row {\n    margin-bottom: 10px;\n}\nbody {\n    overflow: auto;\n    font-weight: 400;\n    -webkit-font-smoothing: antialiased;\n}\n.tb-edit .el-input {\n    display: none;\n}\n.tb-edit .current-row .el-input {\n    display: block;\n}\n.tb-edit .current-row .el-input + span {\n    display: none;\n}\n.tb-edit .el-select {\n    display: none;\n}\n.tb-edit .current-row .el-select {\n    display: block;\n}\n.tb-edit .current-row .el-select + span {\n    display: none;\n}\n.tb-edit .el-input-number {\n    display: none;\n}\n.tb-edit .current-row .el-input-number {\n    display: block;\n}\n.tb-edit .current-row .el-input-number + span {\n    display: none;\n}\n.tb-edit .el-col {\n    display: none;\n}\n.tb-edit .current-row .el-col {\n    display: block;\n}\n.tb-edit .current-row .el-col + span {\n    display: none;\n}\n.tb-edit .el-popover {\n    display: none;\n}\n.tb-edit .current-row .el-popover {\n    display: block;\n}\n.tb-edit .current-row .el-popover + span {\n    display: none;\n}\n.showSpan {\n  display: block;\n}\n.tb-edit .current-row .showSpan {\n  display: none;\n}\n",""])},yqGI:function(n,e,t){var o=t("reL/");"string"==typeof o&&(o=[[n.i,o,""]]),o.locals&&(n.exports=o.locals);t("rjj0")("ba826f78",o,!0)}});