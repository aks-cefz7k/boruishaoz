webpackJsonp([2],{"7VpC":function(t,n,e){(t.exports=e("FZ+f")(!1)).push([t.i,'\n.container-main[data-v-489f0fff] {\n  width: 100%;\n  height: 880px;\n  background: #f8f8f8;\n}\n.container-left[data-v-489f0fff] {\n  float: left;\n  margin-top: 20px;\n  margin-left: 20px;\n  width: 76.8%;\n  height: 840px;\n  background-color: #ffffff;\n  border: solid 1px #e6e6e6;\n}\n.container-right[data-v-489f0fff] {\n  float: left;\n  margin-top: 20px;\n  margin-left: 20px;\n  width: 20%;\n  height: 840px;\n  background-color: #ffffff;\n  border: solid 1px #e6e6e6;\n}\n.container-left-top[data-v-489f0fff] {\n  width: 100%;\n  height: 420px;\n}\n.container-left-bottom[data-v-489f0fff] {\n  width: 100%;\n  height: 400px;\n  background-color: #ffffff;\n}\n.current-phase[data-v-489f0fff] {\n  width: 96%;\n  height: 10px;\n  margin-top: 1%;\n  margin-left: 2%;\n  font-family: SourceHanSansCN-Regular;\n  font-size: 16px;\n  font-weight: normal;\n  font-stretch: normal;\n  line-height: 10px;\n  letter-spacing: 0px;\n  color: #333333;\n}\n.current-phasetable[data-v-489f0fff] {\n  width: 96%;\n  height: 380px;\n  margin-top: 2%;\n  margin-left: 2%;\n}\n.color-block[data-v-489f0fff] {\n  float: left;\n  width: 14px;\n  height: 14px;\n  background-color: #459ffc;\n}\n.curr-phase[data-v-489f0fff] {\n  float: left;\n  margin-left: 5px;\n  margin-top: 1px;\n}\n.curr-ring[data-v-489f0fff] {\n  float: left;\n  margin-left: 20px;\n  margin-top: 1px;\n}\n.phase-order[data-v-489f0fff] {\n  float: left;\n  margin-left: 20px;\n  margin-top: 1px;\n}\n.curr-order[data-v-489f0fff] {\n  float: left;\n  margin-left: 20px;\n  margin-top: 1px;\n}\n.control-right[data-v-489f0fff] {\n  margin-top: 40px;\n  margin-left: 20px;\n}\n.agent-div[data-v-489f0fff] {\n  float: left;\n  width: 28%;\n  height: 420px;\n  border-bottom: solid 0.5px #e6e6e6;\n}\n.other-div[data-v-489f0fff] {\n  float: left;\n  width: 24%;\n  height: 210px;\n  border-left: solid 1px #e6e6e6;\n  border-bottom: solid 1px #e6e6e6;\n}\n.agent-icon[data-v-489f0fff] {\n  position: relative;\n  float: left;\n  width: 50%;\n  height: 210px;\n}\n.agent-num[data-v-489f0fff] {\n  float: left;\n  width: 50%;\n  height: 210px;\n}\n.lianji-success[data-v-489f0fff] {\n  position: relative;\n  float: right;\n  right: 30px;\n  top: 25px;\n  text-align: center;\n  width: 81px;\n  height: 34px;\n  background-color: #409eff;\n  border-radius: 4px;\n  font-size: 14px;\n  padding: 10px 0;\n  color: #ffffff;\n}\n.lianji-fail[data-v-489f0fff] {\n  position: relative;\n  float: right;\n  right: 30px;\n  top: 25px;\n  text-align: center;\n  width: 81px;\n  height: 34px;\n  background-color: #909399;\n  border-radius: 4px;\n  font-size: 14px;\n  padding: 10px 0;\n  color: #ffffff;\n}\n.lianji-wait[data-v-489f0fff] {\n  position: relative;\n  float: right;\n  right: 30px;\n  top: 25px;\n  text-align: center;\n  width: 110px;\n  height: 34px;\n  background-color: #e6a23c;\n  border-radius: 4px;\n  font-size: 14px;\n  padding: 10px 0;\n  color: #ffffff;\n}\n.agent-id[data-v-489f0fff] {\n  margin-top: 20px;\n  margin-right: 30px;\n  text-align: right;\n  font-family: SourceHanSansCN-Regular;\n  font-size: 14px;\n  font-weight: normal;\n  font-stretch: normal;\n  letter-spacing: 0px;\n  color: #999999;\n}\n.agent-number[data-v-489f0fff] {\n  margin-top: 10px;\n  margin-right: 30px;\n  text-align: right;\n  font-family: ArialMT;\n  font-size: 16px;\n  font-weight: normal;\n  font-stretch: normal;\n  letter-spacing: 0px;\n  color: #333333;\n}\n.agent-port[data-v-489f0fff] {\n  margin-top: 20px;\n  margin-right: 30px;\n  text-align: right;\n  font-family: SourceHanSansCN-Regular;\n  font-size: 14px;\n  font-weight: normal;\n  font-stretch: normal;\n  letter-spacing: 0px;\n  color: #999999;\n}\n.port-number[data-v-489f0fff] {\n  margin-top: 10px;\n  margin-right: 30px;\n  text-align: right;\n  font-family: ArialMT;\n  font-size: 16px;\n  font-weight: normal;\n  font-stretch: normal;\n  letter-spacing: 0px;\n  color: #333333;\n}\n.model-name[data-v-489f0fff] {\n  float: left;\n  margin-top: 32px;\n  font-family: SourceHanSansCN-Regular;\n  font-size: 14px;\n  font-weight: normal;\n  font-stretch: normal;\n  letter-spacing: 0px;\n  color: #666666;\n}\n.model-tupian[data-v-489f0fff] {\n  float: left;\n  margin-top: 20px;\n  margin-left: 20px;\n}\n.model-icon[data-v-489f0fff] {\n  width: 40px;\n  height: 40px;\n}\n.control-center[data-v-489f0fff] {\n  text-align: center;\n  margin-top: 40px;\n  font-family: SourceHanSansCN-Regular;\n  font-size: 30px;\n  font-weight: normal;\n  font-stretch: normal;\n  line-height: 20px;\n  letter-spacing: 0px;\n  color: #333333;\n}\n.curr-grade[data-v-489f0fff] {\n  margin-top: 30px;\n  font-family: SourceHanSansCN-Regular;\n  font-size: 24px;\n  font-weight: normal;\n  font-stretch: normal;\n  line-height: 14px;\n  letter-spacing: 0px;\n  color: #666666;\n}\n.curr-num[data-v-489f0fff] {\n  margin-top: 20px;\n  font-family: SourceHanSansCN-Regular;\n  font-size: 14px;\n  font-weight: normal;\n  font-stretch: normal;\n  line-height: 14px;\n  letter-spacing: 0px;\n  color: #999999;\n}\n.icon-ziyuan[data-v-489f0fff]:before {\n  content: "\\E670";\n  position: absolute;\n  z-index: 2;\n  left: 45px;\n  top: 72px;\n}\n.yuanxing[data-v-489f0fff] {\n  position: absolute;\n  left: 20px;\n  top: 50px;\n  z-index: 1;\n  width: 90px;\n  height: 90px;\n  opacity: 0.2;\n  border-radius: 50%;\n}\n.dev-status[data-v-489f0fff] {\n  position: absolute;\n  top: 150px;\n  height: 21px;\n  font-family: SourceHanSansCN-Regular;\n  font-size: 22px;\n  font-weight: normal;\n  font-stretch: normal;\n  line-height: 14px;\n  letter-spacing: 0px;\n}\n',""])},ARoL:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=e("BO1k"),r=e.n(a),o=e("fZjL"),i=e.n(o),l=e("ifoU"),s=e.n(l),c=e("sGqM"),f=e("TPc2"),d=e("TIfe"),p={name:"overview",data:function(){return{controlData:{},form:{control:"",pattern:"",mode:""},spanArr:[],list:[{iconClass:"model",name:"控制模式",value:"--"},{iconClass:"cycle",name:"周期",value:"--"},{iconClass:"time",name:"当前时间",value:"--"},{iconClass:"maincontrol",name:"控制方式",value:"--"},{iconClass:"phasediff",name:"相位差",value:"--"},{iconClass:"time",name:"剩余时间",value:"--"}],tableData:[],phaseControlTimer:null,ParamsMap:new s.a([["控制模式","mode"],["周期","cycle"],["控制方式","control"],["相位差","offset"],["当前时间","curTime"],["剩余时间","syncTime"]]),ParamsMode:new s.a([[0,"默认模式"],[1,"自主模式"],[2,"中心模式"],[3,"边缘模式"],[4,"遥控器模式"],[5,"手动面板模式"],[6,"勤务模式"],[7,"优化模式"]]),ParamsControl:new s.a([[0,"自主控制"],[1,"黄闪"],[2,"全红"],[3,"关灯"],[4,"步进"],[5,"定周期控制"],[6,"单点感应控制"],[7,"协调感应控制"],[8,"方案选择控制"],[9,"自适应控制"],[10,"优化控制"]]),phaseType:new s.a([[1,"红"],[2,"黄"],[3,"绿"]]),ip:"--",port:"--",protocol:"--",devStatus:1,mode:"2",loading:{},agentId:"0"}},watch:{$route:{handler:function(t,n){void 0!==t.query&&(this.agentId=this.$route.query.agentid,Object(d.h)(this.agentId),this.ip=this.$route.query.IP,this.port=this.$route.query.port,this.protocol=this.$route.query.protocol)},deep:!0}},created:function(){void 0!==this.$route.query&&(this.agentId=this.$route.query.agentid,Object(d.h)(this.agentId),this.ip=this.$route.query.IP,this.port=this.$route.query.port,this.protocol=this.$route.query.protocol),this.registerMessage()},mounted:function(){},methods:{registerMessage:function(){var t=this;Object(f.e)(this.agentId).then(function(n){if(!n.data.success)return t.devStatus=2,"4003"===n.data.code?void t.$message.error(t.$t("edge.errorTip.devicenotonline")):void t.$message.error("通讯异常！");t.devStatus=3,t.clearPatternInterval(),t.phaseControlTimer=setInterval(function(){t.initData()},1e3)})},clearPatternInterval:function(){null!==this.phaseControlTimer&&(clearInterval(this.phaseControlTimer),this.phaseControlTimer=null)},initData:function(){var t=this;Object(c.b)(this.agentId).then(function(n){if(!n.data.success)return"4003"===n.data.code?(t.devStatus=2,t.clearPatternInterval(),void t.$message.error(t.$t("edge.errorTip.devicenotonline"))):void t.$message.error(n.data.message);t.controlData=t.handleGetData(n.data.data.data),t.handleList(t.controlData),t.handleTableData(t.controlData)}).catch(function(n){t.$message.error(n),console.log(n)})},handleObjectSpan:function(){var t=this,n=0;this.spanArr=[],this.tableData.forEach(function(e,a){e.index=a,0===a?t.spanArr.push(1):e.ring===t.tableData[a-1].ring?(t.spanArr[n]+=1,t.spanArr.push(0)):(t.spanArr.push(1),n=a)})},objectSpanMethod:function(t){t.row,t.column;var n=t.rowIndex;if(0===t.columnIndex){var e=this.spanArr[n];return{rowspan:e,colspan:e>0?1:0}}},onSubmit:function(){var t=this;this.lockScreen();var n={};n.control=Number(this.form.control),n.pattern=Number(this.form.pattern),Object(c.e)(n).then(function(n){t.unlockScreen(),n.data.success?t.$alert(t.$t("edge.common.download"),{type:"success"}):t.$message.error(n.data.message)}).catch(function(n){t.unlockScreen(),t.$message.error(n),console.log(n)})},onGet:function(){var t=this;this.lockScreen(),Object(c.d)(this.agentId).then(function(n){if(t.unlockScreen(),n.data.success){t.$message.success(t.$t("edge.common.querysucess"));var e=n.data.data.data;t.form.control=String(e.control),t.form.pattern=String(e.pattern),t.form.mode=t.ParamsMode.get(e.mode)}else t.$message.error(n.data.message)}).catch(function(n){t.unlockScreen(),t.$message.error(n),console.log(n)})},handleGetData:function(t){var n=this;return""===t.name&&(t.name="方案"+t.patternid),i()(t).forEach(function(e){if("mode"===e&&(t[e]>0&&t[e]<6?t[e]=n.ParamsMode.get(t[e]):t[e]=n.ParamsMode.get(0)),"control"===e&&(t[e]=n.ParamsControl.get(t[e])),"phase"===e){var a=!0,o=!1,i=void 0;try{for(var l,s=r()(t[e]);!(a=(l=s.next()).done);a=!0){var c=l.value;c.type=n.phaseType.get(c.type)}}catch(t){o=!0,i=t}finally{try{!a&&s.return&&s.return()}finally{if(o)throw i}}}}),t},handleList:function(t){var n=!0,e=!1,a=void 0;try{for(var o,i=r()(this.list);!(n=(o=i.next()).done);n=!0){var l=o.value,s=this.ParamsMap.get(l.name);l.value=t[s]}}catch(t){e=!0,a=t}finally{try{!n&&i.return&&i.return()}finally{if(e)throw a}}},handleTableData:function(t){this.tableData=[];var n=t.phase,e=t.rings,a=!0,o=!1,i=void 0;try{for(var l,s=r()(e);!(a=(l=s.next()).done);a=!0){var c=l.value,f=c.sequence,d=!0,p=!1,v=void 0;try{for(var u,h=r()(f);!(d=(u=h.next()).done);d=!0){var g=u.value,m={};m.ring=c.num,m.phase=g;var x=!0,b=!1,_=void 0;try{for(var y,w=r()(n);!(x=(y=w.next()).done);x=!0){var C=y.value;g===C.id&&(m.phase_countdown=C.phase_countdown,m.split=C.split,m.countdown=C.countdown,m.id=C.id,m.type=C.type,m.light_countdown=C.light_countdown)}}catch(t){b=!0,_=t}finally{try{!x&&w.return&&w.return()}finally{if(b)throw _}}this.tableData.push(m)}}catch(t){p=!0,v=t}finally{try{!d&&h.return&&h.return()}finally{if(p)throw v}}}}catch(t){o=!0,i=t}finally{try{!a&&s.return&&s.return()}finally{if(o)throw i}}this.handleObjectSpan()},lockScreen:function(){this.loading=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"})},unlockScreen:function(){this.loading.close()},addClass:function(t){var n=t.row;t.column,t.rowIndex;if(2===t.columnIndex){if("绿"===n.type)return"green";if("红"===n.type)return"red";if("黄"===n.type)return"yellow"}}},destroyed:function(){this.clearPatternInterval()}},v={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"container-main"},[e("div",{staticClass:"container-left"},[e("div",{staticClass:"container-left-top"},[e("div",{staticClass:"agent-div"},[e("div",{staticStyle:{height:"210px"}},[e("div",{staticClass:"agent-icon"},[e("div",{directives:[{name:"show",rawName:"v-show",value:3===t.devStatus,expression:"devStatus===3"}]},[e("div",{staticClass:"yuanxing",staticStyle:{background:"rgba(64, 158, 255, 0.6)"}}),e("div",{staticClass:"iconfont icon-ziyuan",staticStyle:{color:"#409eff"}}),e("div",{staticClass:"dev-status",staticStyle:{color:"#409eff",left:"40px"}},[t._v("在线")])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:2===t.devStatus,expression:"devStatus===2"}]},[e("div",{staticClass:"yuanxing",staticStyle:{background:"rgba(179, 179, 179, 0.6)"}}),e("div",{staticClass:"iconfont icon-ziyuan",staticStyle:{color:"#b3b3b3"}}),e("div",{staticClass:"dev-status",staticStyle:{color:"#b3b3b3",left:"40px"}},[t._v("离线")])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:1===t.devStatus,expression:"devStatus===1"}]},[e("div",{staticClass:"yuanxing",staticStyle:{background:"rgba(230, 162, 60, 0.6)"}}),e("div",{staticClass:"iconfont icon-ziyuan",staticStyle:{color:"#e6a23c"}}),e("div",{staticClass:"dev-status",staticStyle:{color:"#e6a23c",left:"30px"}},[t._v("联机中")])])]),t._v(" "),e("div",{staticClass:"agent-num"},[e("div",{staticClass:"agent-id"},[t._v("IP地址")]),t._v(" "),e("div",{staticClass:"agent-number"},[t._v(t._s(t.ip))]),t._v(" "),e("div",{staticClass:"agent-port"},[t._v("设备端口")]),t._v(" "),e("div",{staticClass:"port-number"},[t._v(t._s(t.port))]),t._v(" "),e("div",{staticClass:"agent-port"},[t._v("协议")]),t._v(" "),e("div",{staticClass:"port-number"},[t._v(t._s(t.protocol))])])]),t._v(" "),e("div",{staticStyle:{height:"210px"}},[e("div",{staticStyle:{float:"left",height:"50%",width:"50%","text-align":"center"}},[e("div",{staticClass:"curr-grade"},[t._v(t._s(t.controlData.current_stage))]),t._v(" "),e("div",{staticClass:"curr-num"},[t._v("当前阶段")])]),t._v(" "),e("div",{staticStyle:{float:"right",height:"50%",width:"50%","text-align":"center"}},[e("div",{staticClass:"curr-grade"},[t._v(t._s(t.controlData.total_stages))]),t._v(" "),e("div",{staticClass:"curr-num"},[t._v("总阶段数")])]),t._v(" "),e("div",{staticStyle:{float:"left",height:"50%",width:"50%","text-align":"center"}},[e("div",{staticClass:"curr-grade"},[t._v(t._s(t.controlData.patternid))]),t._v(" "),e("div",{staticClass:"curr-num"},[t._v("方案编号")])]),t._v(" "),e("div",{staticStyle:{float:"right",height:"50%",width:"50%","text-align":"center"}},[e("div",{staticClass:"curr-grade"},[t._v(t._s(t.controlData.name))]),t._v(" "),e("div",{staticClass:"curr-num"},[t._v("方案名称")])])])]),t._v(" "),t._l(t.list,function(n,a){return e("div",{key:a,staticClass:"other-div"},[e("div",{staticStyle:{height:"70px"}},[e("div",{staticClass:"model-tupian"},[e("svg-icon",{attrs:{"icon-class":n.iconClass,className:"model-icon"}})],1),e("div",{staticClass:"model-name"},[t._v(t._s(n.name))])]),t._v(" "),e("div",{staticStyle:{height:"140px"}},[e("div",{staticClass:"control-center"},[t._v(t._s(n.value))])])])})],2),t._v(" "),e("div",{staticClass:"container-left-bottom"},[e("div",{staticClass:"current-phase"},[e("div",{staticClass:"color-block"}),t._v(" "),e("div",{staticClass:"curr-phase"},[e("span",[t._v(t._s(t.$t("edge.control.current_phase")))]),t._v(" "),t._l(t.controlData.current_phase,function(n,a){return e("span",{key:a},[e("span",0===a?[t._v(t._s(n))]:[t._v(t._s(", "+n))])])})],2),t._v(" "),t._l(t.controlData.rings,function(n,a){return e("div",{key:a,staticClass:"curr-phase"},[e("div",{staticClass:"curr-ring"},[e("span",[t._v(t._s(t.$t("edge.control.ring"))+": ")]),e("span",[t._v(t._s(n.num))])]),t._v(" "),e("div",{staticClass:"phase-order"},[e("span",[t._v(t._s(t.$t("edge.control.sequence"))+" ")]),e("span",[t._v(t._s(n.sequence))])])])})],2),t._v(" "),e("div",{staticClass:"current-phasetable"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"span-method":t.objectSpanMethod,"cell-class-name":t.addClass,size:"mini"}},[e("el-table-column",{attrs:{align:"center",prop:"ring",label:"环"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"id",label:"相位id"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"phase_countdown",label:"相位倒计时"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"split",label:"绿信比"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",prop:"type",label:"相位类型"}})],1)],1)])]),t._v(" "),e("div",{staticClass:"container-right"},[e("div",{staticClass:"control-right"},[e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[""!=t.form.mode?e("el-form-item",{attrs:{label:t.$t("edge.control.mode_style")}},[e("div",[t._v(t._s(t.form.mode))])]):t._e(),t._v(" "),e("el-form-item",{attrs:{label:t.$t("edge.control.control_style")}},[e("el-select",{attrs:{placeholder:t.$t("edge.common.select")},model:{value:t.form.control,callback:function(n){t.$set(t.form,"control",n)},expression:"form.control"}},[e("el-option",{attrs:{label:"默认",value:"0"}}),t._v(" "),e("el-option",{attrs:{label:"黄闪",value:"1"}}),t._v(" "),e("el-option",{attrs:{label:"全红",value:"2"}}),t._v(" "),e("el-option",{attrs:{label:"关灯",value:"3"}}),t._v(" "),e("el-option",{attrs:{label:"步进",value:"4"}}),t._v(" "),e("el-option",{attrs:{label:"定周期控制",value:"5"}}),t._v(" "),e("el-option",{attrs:{label:"单点感应控制",value:"6"}}),t._v(" "),e("el-option",{attrs:{label:"协调感应控制",value:"7"}}),t._v(" "),e("el-option",{attrs:{label:"方案选择控制",value:"8"}}),t._v(" "),e("el-option",{attrs:{label:"自适应控制",value:"9"}}),t._v(" "),e("el-option",{attrs:{label:"优化控制",value:"10"}})],1)],1),t._v(" "),e("el-form-item",{attrs:{label:t.$t("edge.control.pattern")}},[e("el-input",{staticStyle:{width:"70%"},model:{value:t.form.pattern,callback:function(n){t.$set(t.form,"pattern",n)},expression:"form.pattern"}})],1),t._v(" "),e("el-form-item",[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.onSubmit}},[t._v(t._s(t.$t("edge.common.setup")))]),t._v(" "),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.onGet}},[t._v(t._s(t.$t("edge.common.query")))])],1)],1)],1)])])},staticRenderFns:[]};var u=e("VU/8")(p,v,!1,function(t){e("Tfhg"),e("WcrD")},"data-v-489f0fff",null);n.default=u.exports},Tfhg:function(t,n,e){var a=e("7VpC");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);e("rjj0")("3d070236",a,!0)},WcrD:function(t,n,e){var a=e("aax9");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);e("rjj0")("9d8204fc",a,!0)},aax9:function(t,n,e){(t.exports=e("FZ+f")(!1)).push([t.i,"\n.container-right .el-form-item__label {\n  text-align: right;\n  float: left;\n  font-size: 14px;\n  line-height: 40px;\n  padding: 0 12px 0 0;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n  font-family: SourceHanSansCN-Regular;\n  font-weight: normal;\n  font-stretch: normal;\n  letter-spacing: 0px;\n  color: #999999;\n}\n.container-right .el-select {\n  width: 70%;\n}\n.current-phasetable .yellow {\n  color: #ffd000;\n}\n.current-phasetable .red {\n  color: #ff1b1b;\n}\n.current-phasetable .green {\n  color: #20b84e;\n}\n",""])}});