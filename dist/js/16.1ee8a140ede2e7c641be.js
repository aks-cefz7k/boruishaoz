webpackJsonp([16],{"T+/8":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("M9A7"),s=o("TIfe"),i=o("XGK3"),a=o("sGqM"),r={name:"login",components:{changePass:i.a},props:{loginInterface:{type:Object}},data:function(){var e=this;return{loginForm:{user_name:"",password:"",ip:"localhost",port:"8880",protocol:"ocp",agentid:"0"},loginRules:{user_name:[{required:!0,trigger:"blur",message:this.$t("edge.login.usernamenotnull")}],password:[{required:!0,trigger:"blur",message:this.$t("edge.login.passnotnull")}],protocol:[{required:!0,message:this.$t("edge.login.selectagreement"),trigger:"blur"}],ip:[{validator:function(t,o,n){if(""===o)return n(new Error(e.$t("edge.login.enterip")));if(!/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/.test(o)&&"localhost"!==o)return e.ip_status=!1,n(new Error(e.$t("edge.login.enterlegalip")));e.ip_status=!0,n()},trigger:"blur"}],port:[{validator:function(t,o,n){if(""===o)return n(new Error(e.$t("edge.login.enterpport")));var s=/^([0-9]|[1-9]\d{1,3}|[1-5]\d{4}|6[0-4]\d{4}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])$/;setTimeout(function(){s.test(o)?(e.port_status=!0,n()):(e.port_status=!1,n(new Error(e.$t("edge.login.entercorrectport"))))},100)},trigger:"blur"}],agentid:[{required:!0,message:this.$t("edge.login.enterdeviceid"),trigger:"blur"}]},loading:!1,pwdType:"password",language:"Language",isExpand:!1}},created:function(){},mounted:function(){this.showLoginInfo()},methods:{showLoginInfo:function(){var e=this.loginInterface.getLoginInfo();e&&(e=JSON.parse(e),this.loginForm.user_name=e.user_name,this.loginForm.ip=e.ip,this.loginForm.port=e.port,this.loginForm.protocol=e.protocol)},showPwd:function(){"password"===this.pwdType?this.pwdType="":this.pwdType="password"},handleLogin:function(){var e=this;this.$refs.loginForm.validate(function(t){if(!t)return console.log("error submit!!"),!1;e.loading=!0,Object(n.b)(e.loginForm.user_name,e.loginForm.password).then(function(t){return!0!==t.data.success?(e.$message.error(e.$t("edge.login.loginerror")),void(e.loading=!1)):(e.loading=!1,t.data.data.expire&&void 0!==t.data.data.token?(Object(s.j)(t.data.data.token),void e.modifyPasswd()):(Object(s.a)(e.loginForm.user_name),e.loginInterface.loginSucess(t.data.data.token),e.addDevice(),void e.loginInterface.setLoginInfo(e.loginForm)))}).catch(function(t){e.loading=!1,e.$message.error(t),e.loginInterface.loginFailed(t)})})},switchLanguage:function(e){switch(e){case"Ch":this.switchToChinese();break;case"En":this.switchToEngLish();break;default:console.log(e)}},switchToChinese:function(){this.$i18n.locale="zh",Object(s.i)(this.$i18n.locale)},switchToEngLish:function(){this.$i18n.locale="en",Object(s.i)(this.$i18n.locale)},modifyPasswd:function(){this.$refs.changepassChild.onChangePassClick(this.loginForm.user_name)},handleExpand:function(){this.isExpand=!this.isExpand},resetParams:function(){this.loginForm.ip="localhost",this.loginForm.port="8880",this.loginForm.protocol="ocp",this.loginForm.agentid="0"},addDevice:function(){var e=this,t={};t.protocol=this.loginForm.protocol,t.ip=this.loginForm.ip,t.port=this.loginForm.port,t.type="asc",t.agentid=this.loginForm.agentid,Object(s.h)(this.loginForm.agentid),Object(a.a)(t).then(function(t){t.data.success||(console.log(new Error(t.data.message)),e.$message({message:t.data.message,type:"error",duration:1e3}))})}}},l={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"login-container"},[o("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{"auto-complete":"on",model:e.loginForm,rules:e.loginRules,"label-position":"left"}},[o("h3",{staticClass:"title"},[e._v(e._s(e.$t("edge.login.title")))]),e._v(" "),o("el-form-item",{attrs:{prop:"user_name"}},[o("span",{staticClass:"svg-container svg-container_login"},[o("svg-icon",{attrs:{"icon-class":"user"}})],1),e._v(" "),o("el-input",{staticClass:"login-input",attrs:{name:"user_name",type:"text","auto-complete":"on",placeholder:e.$t("edge.login.username")},model:{value:e.loginForm.user_name,callback:function(t){e.$set(e.loginForm,"user_name",t)},expression:"loginForm.user_name"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"password"}},[o("span",{staticClass:"svg-container"},[o("svg-icon",{attrs:{"icon-class":"password"}})],1),e._v(" "),o("el-input",{staticClass:"login-input",attrs:{name:"password",type:e.pwdType,"auto-complete":"on",placeholder:e.$t("edge.login.password"),onpaste:"return false",oncontextmenu:"return false",oncopy:"return false",oncut:"return false"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}}),e._v(" "),o("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[o("svg-icon",{attrs:{"icon-class":"eye"}})],1)],1),e._v(" "),o("div",[o("el-checkbox",{staticClass:"expand-text",model:{value:e.isExpand,callback:function(t){e.isExpand=t},expression:"isExpand"}},[e._v(e._s(e.$t("edge.login.networkparam")))])],1),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.isExpand,expression:"isExpand"}]},[o("el-form-item",{attrs:{prop:"ip"}},[o("span",{staticClass:"text-container"},[e._v("IP")]),e._v(" "),o("el-input",{staticClass:"login-input",attrs:{name:"IP",type:"text","auto-complete":"on",placeholder:""},model:{value:e.loginForm.ip,callback:function(t){e.$set(e.loginForm,"ip",t)},expression:"loginForm.ip"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"port"}},[o("span",{staticClass:"text-container"},[e._v(e._s(e.$t("edge.login.port")))]),e._v(" "),o("el-input",{staticClass:"login-input",attrs:{name:"port",type:"text","auto-complete":"on",placeholder:""},model:{value:e.loginForm.port,callback:function(t){e.$set(e.loginForm,"port",t)},expression:"loginForm.port"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"protocol"}},[o("span",{staticClass:"text-container"},[e._v(e._s(e.$t("edge.login.protocol")))]),e._v(" "),o("el-select",{attrs:{placeholder:""},model:{value:e.loginForm.protocol,callback:function(t){e.$set(e.loginForm,"protocol",t)},expression:"loginForm.protocol"}},[o("el-option",{attrs:{label:"scp",value:"scp"}}),e._v(" "),o("el-option",{attrs:{label:"ocp",value:"ocp"}})],1)],1),e._v(" "),o("div",{staticClass:"expand-text",staticStyle:{float:"right"},on:{click:e.resetParams}},[e._v("\n            "+e._s(e.$t("edge.login.restoredefaultparameters"))+"\n        ")])],1),e._v(" "),o("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.loading},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e._v("\n          "+e._s(e.$t("edge.login.login"))+"\n        ")])],1)],1),e._v(" "),o("changePass",{ref:"changepassChild"})],1)},staticRenderFns:[]};var c=o("VU/8")(r,l,!1,function(e){o("YhxJ")},null,null);t.default=c.exports},YhxJ:function(e,t,o){var n=o("fgmX");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);o("rjj0")("4ac252da",n,!0)},fgmX:function(e,t,o){(e.exports=o("FZ+f")(!1)).push([e.i,"",""])}});